{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>üìã Verificaci√≥n de Documentos M√©dicos</h1>
        <a href="{{ url_for('main.admin_panel') }}" class="btn btn-secondary">‚Üê Volver al Panel</a>
    </div>

    <!-- Informaci√≥n del Solicitante -->
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">üë®‚Äç‚öïÔ∏è Informaci√≥n del Solicitante</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Nombre:</strong> {{ usuario.username }}</p>
                    <p><strong>Email:</strong> {{ usuario.email }}</p>
                    <p><strong>ID Usuario:</strong> {{ usuario.id }}</p>
                    <p><strong>Rol Actual:</strong> {{ usuario.rol }}</p>
                    <p><strong>Estado:</strong> {{ usuario.estado_verificacion }}</p>
                </div>
                <div class="col-md-6">
                    <p><strong>Especialidad Solicitada:</strong> <span class="badge bg-info">{{ solicitud.especialidad }}</span></p>
                    <p><strong>Licencia M√©dica:</strong> {{ solicitud.licencia_medica }}</p>
                    <p><strong>Instituci√≥n:</strong> {{ solicitud.institucion }}</p>
                    <p><strong>Experiencia:</strong> {{ solicitud.experiencia_anos }} a√±os</p>
                    <p><strong>Fecha Solicitud:</strong> {{ solicitud.fecha_solicitud.strftime('%d/%m/%Y %H:%M') }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Documentos Subidos -->
    <div class="card mb-4">
        <div class="card-header bg-info text-white">
            <h5 class="mb-0">üìÑ Documentos Subidos</h5>
        </div>
        <div class="card-body">
            <!-- Licencia M√©dica -->
            <div class="documento-item mb-4 p-3 border rounded">
                <h6>üìú Licencia M√©dica <span class="badge bg-primary">REQUERIDO</span></h6>
                <p><strong>N√∫mero de Licencia:</strong> {{ solicitud.licencia_medica }}</p>
                <p><strong>Instituci√≥n:</strong> {{ solicitud.institucion }}</p>
                {% if solicitud.url_licencia %}
                    <a href="{{ solicitud.url_licencia }}" target="_blank" class="btn btn-outline-primary btn-sm">
                        üîç Ver Documento de Licencia
                    </a>
                    <small class="text-muted ms-2">Enlace: {{ solicitud.url_licencia[:50] }}...</small>
                {% else %}
                    <span class="text-danger">‚ùå No se proporcion√≥ enlace</span>
                {% endif %}
            </div>

            <!-- Documento de Identidad -->
            <div class="documento-item mb-4 p-3 border rounded">
                <h6>üÜî Documento de Identidad <span class="badge bg-primary">REQUERIDO</span></h6>
                {% if solicitud.url_identidad %}
                    <a href="{{ solicitud.url_identidad }}" target="_blank" class="btn btn-outline-primary btn-sm">
                        üîç Ver Documento de Identidad
                    </a>
                    <small class="text-muted ms-2">Enlace: {{ solicitud.url_identidad[:50] }}...</small>
                {% else %}
                    <span class="text-danger">‚ùå No se proporcion√≥ enlace</span>
                {% endif %}
            </div>

            <!-- Curriculum Vitae -->
            <div class="documento-item mb-4 p-3 border rounded">
                <h6>üìù Curriculum Vitae (CV) <span class="badge bg-secondary">OPCIONAL</span></h6>
                {% if solicitud.url_cv %}
                    <a href="{{ solicitud.url_cv }}" target="_blank" class="btn btn-outline-primary btn-sm">
                        üîç Ver Curriculum Vitae
                    </a>
                    <small class="text-muted ms-2">Enlace: {{ solicitud.url_cv[:50] }}...</small>
                {% else %}
                    <span class="text-warning">‚ö†Ô∏è No se proporcion√≥ CV (opcional)</span>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Biograf√≠a y Experiencia -->
    <div class="card mb-4">
        <div class="card-header bg-success text-white">
            <h5 class="mb-0">üìù Biograf√≠a Profesional</h5>
        </div>
        <div class="card-body">
            <p><strong>A√±os de Experiencia:</strong> <span class="badge bg-warning">{{ solicitud.experiencia_anos }} a√±os</span></p>
            <p><strong>Biograf√≠a:</strong></p>
            <div class="border p-3 bg-light rounded">
                {{ solicitud.biografia | replace('\n', '<br>') | safe }}
            </div>
        </div>
    </div>

    <!-- Checklist de Verificaci√≥n -->
    <div class="card mb-4">
        <div class="card-header bg-warning">
            <h5 class="mb-0">‚úÖ Checklist de Verificaci√≥n</h5>
        </div>
        <div class="card-body">
            <div class="form-check mb-2">
                <input class="form-check-input" type="checkbox" id="check_licencia">
                <label class="form-check-label" for="check_licencia">
                    Licencia m√©dica es v√°lida y corresponde al solicitante
                </label>
            </div>
            <div class="form-check mb-2">
                <input class="form-check-input" type="checkbox" id="check_identidad">
                <label class="form-check-label" for="check_identidad">
                    Documento de identidad es leg√≠timo y coincide con la licencia
                </label>
            </div>
            <div class="form-check mb-2">
                <input class="form-check-input" type="checkbox" id="check_especialidad">
                <label class="form-check-label" for="check_especialidad">
                    Especialidad declarada es consistente con la documentaci√≥n
                </label>
            </div>
            <div class="form-check mb-2">
                <input class="form-check-input" type="checkbox" id="check_experiencia">
                <label class="form-check-label" for="check_experiencia">
                    Experiencia declarada es cre√≠ble y verificable
                </label>
            </div>
        </div>
    </div>

    <!-- Acciones de Verificaci√≥n -->
    <div class="card">
        <div class="card-header bg-danger text-white">
            <h5 class="mb-0">‚ö° Acciones de Verificaci√≥n</h5>
        </div>
        <div class="card-body">
            <div class="alert alert-info">
                <strong>Instrucciones:</strong> Revise todos los documentos antes de tomar una decisi√≥n.
                Verifique que los documentos sean leg√≠timos, est√©n vigentes y correspondan al solicitante.
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('main.aprobar_medico', usuario_id=usuario.id) }}" 
                           class="btn btn-success btn-lg"
                           onclick="return confirm('¬øEST√Å SEGURO DE APROBAR a {{ usuario.username }} como m√©dico?\\n\\n‚úÖ El usuario ser√° convertido a m√©dico\\n‚úÖ Tendr√° acceso al panel m√©dico\\n‚úÖ Podr√° recibir citas de pacientes')">
                            ‚úÖ Aprobar como M√©dico
                        </a>
                        <small class="text-muted text-center">Usuario: {{ usuario.username }} ‚Üí Rol: M√âDICO</small>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('main.rechazar_medico', usuario_id=usuario.id) }}" 
                           class="btn btn-danger btn-lg"
                           onclick="return confirm('¬øEST√Å SEGURO DE RECHAZAR la solicitud de {{ usuario.username }}?\\n\\n‚ùå El usuario permanecer√° como paciente\\n‚ùå La solicitud ser√° marcada como rechazada\\n‚ùå Podr√° enviar una nueva solicitud en el futuro')">
                            ‚ùå Rechazar Solicitud
                        </a>
                        <small class="text-muted text-center">Usuario: {{ usuario.username }} ‚Üí Rol: PACIENTE</small>
                    </div>
                </div>
            </div>

            <!-- Notas Adicionales -->
            <div class="mt-4">
                <div class="alert alert-secondary">
                    <strong>üìä Resumen de Documentaci√≥n:</strong><br>
                    ‚Ä¢ Licencia m√©dica: {% if solicitud.url_licencia %}‚úÖ Proporcionada{% else %}‚ùå Faltante{% endif %}<br>
                    ‚Ä¢ Documento identidad: {% if solicitud.url_identidad %}‚úÖ Proporcionado{% else %}‚ùå Faltante{% endif %}<br>
                    ‚Ä¢ Curriculum Vitae: {% if solicitud.url_cv %}‚úÖ Proporcionado{% else %}‚ö†Ô∏è Opcional{% endif %}<br>
                    ‚Ä¢ Biograf√≠a: {% if solicitud.biografia %}‚úÖ Proporcionada{% else %}‚ùå Faltante{% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.documento-item {
    background-color: #f8f9fa;
}
.documento-item:hover {
    background-color: #e9ecef;
}
</style>
{% endblock %}